/*! configurator 22-09-2014 */
!function(a,b){"use strict";function c(a){return Object.prototype.toString.call(a)}function d(a,b,c){Error.apply(this,[c]),this.node=a,this.name="AssertError",this.assert=b,this.message=a.getLongname()+": "+c}function e(a,b){this.test=function(c,e){if(A.isArray(e)){if(A.isNumber(a)&&e.length<a)throw new d(c,"CountAssert","Expected array to contain "+a+" or more values");if(A.isNumber(b)&&e.length>b)throw new d(c,"CountAssert","Expected array to contain "+b+" or less values")}}}function f(a){this.args=Array.prototype.slice.call(arguments,0),this.test=function(b,c){if(A.isString(c)&&c.length<=a)throw new d(b,"GreaterThanAssert","Expected value to contain "+a+" or more characters");if(A.isNumber(c)&&a>=c)throw new d(b,"GreaterThanAssert","Expected value to be greater than "+a+" but is "+c);return!0}}function g(a){this.test=function(b,c){if(A.isString(c)&&c.length>=a)throw new d(b,"LessThanAssert","Expected value to contain "+a+" or less characters");if(A.isNumber(c)&&c>=a)throw new d(b,"LessThanAssert","Expected value to be less than "+a+" but is "+c);return!0}}function h(a,b){var c;A.isRegexp(a)?c=a:A.isString(a)&&(c=new RegExp(a));var e=b||!0;this.test=function(a,b){if(!0!==A.isRegexp(c))throw new d(a,"WrongRegexAssert","Regex not valid");if(c.test(b)!==e)throw new d(a,"RegexAssert","Expected value to match regex `"+c.toString()+"`")}}function i(a){this.test=function(b,c){if(A.isArray(a)&&-1===a.indexOf(c))throw new d(b,"ChoiceAssert","Given value is not a valid choice, choose from ["+a.join(",")+"]")}}function j(){this.test=function(a,b){if(""===b)throw new d(a,"NotEmptyAssert","Expect value not to be blank")}}function k(){this.test=function(a,b){if(!1===A.isString(b))throw new d(a,"String","type mismatch expected `[object String]` got `"+A.callToString(b)+"`");return!0}}function l(){this.test=function(a,b){if(!1===A.isNumber(b))throw new d(a,"Number","type mismatch expected `[object Number]` got `"+A.callToString(b)+"`");return!0}}function m(){this.test=function(a,b){if(!1===A.isBoolean(b))throw new d(a,"Boolean","type mismatch expected `[object Boolean]` got `"+A.callToString(b)+"`");return!0}}function n(){this.test=function(a,b){if(!1===A.isObject(b))throw new d(a,"Object","type mismatch expected `[object Object]` got `"+A.callToString(b)+"`");return!0}}function o(){this.test=function(a,b){if(!1===A.isArray(b))throw new d(a,"Array","type mismatch expected `[object Array]` got `"+A.callToString(b)+"`");return!0}}function p(){this.test=function(a,b){if(!1===A.isFunction(b))throw new d(a,"Function","type mismatch expected `[object Function]` got `"+A.callToString(b)+"`");return!0}}function q(a,c,d,e,f){if(this.name=a,this.parent=e,this.isRequired=!1,this.childNodes={},this.nodeChildren=null,this.allowChildNodes=f||!1,this.asserts=c?[c]:[],this.defaultValue=null,this.value=b,!0===this.allowChildNodes&&!0===A.isArray(d)&&d.length>0)for(var g=0;g<d.length;g++)d[g].parent=this,this.childNodes[d[g].name]=d[g];e&&e.childNodes&&(e.childNodes[a]=this)}function r(a,b,c){q.apply(this,[a,new o,b,c,!0]),this.count=function(a,b){return this.asserts.push(new e(a,b)),this}}function s(a,b,c){q.apply(this,[a,new m,b,c,!1])}function t(a,b,c){q.apply(this,[a,new p,b,c,!1])}function u(a,b,c){q.apply(this,[a,null,b,c,!0]),this.greaterThan=function(a){return this.asserts.push(new f(a)),this},this.lessThan=function(a){return this.asserts.push(new g(a)),this},this.choice=function(a){return this.asserts.push(new i(a)),this},this.notEmpty=function(){return this.asserts.push(new j),this}}function v(a){this.objectNode=function(b){return new x(b,null,a)},this.arrayNode=function(b){return new r(b,null,a)},this.stringNode=function(b){return new y(b,null,a)},this.booleanNode=function(b){return new s(b,null,a)},this.numberNode=function(b){return new w(b,null,a)},this.mixedNode=function(b){return new u(b,null,a)},this.functionNode=function(b){return new t(b,null,a)},this.end=function(){return a}}function w(a,b,c){q.apply(this,[a,new l,b,c,!1]),this.greaterThan=function(a){return this.asserts.push(new f(a)),this},this.lessThan=function(a){return this.asserts.push(new g(a)),this},this.choice=function(a){return this.asserts.push(new i(a)),this}}function x(a,b,c){q.apply(this,[a,new n,b,c,!0])}function y(a,b,c){q.apply(this,[a,new k,b,c,!1]),this.greaterThan=function(a){return this.asserts.push(new f(a)),this},this.lessThan=function(a){return this.asserts.push(new g(a)),this},this.choice=function(a){return this.asserts.push(new i(a)),this},this.notEmpty=function(){return this.asserts.push(new j),this}}function z(a){return a&&"[object Array]"===Object.prototype.toString.call(a)?new x("root",a,null):new x("root",null,null)}var A={};A.callToString=c,A.isString=function(a){return"string"==typeof a||"[object String]"==c(a)},A.isNumber=function(a){return"number"==typeof a||"[object Number]"==c(a)},A.isBoolean=function(a){return"boolean"==typeof a||"[object Boolean]"==c(a)},A.isFunction=function(a){return"function"==typeof a||"[object Function]"===c(a)},A.isObject=function(a){return"[object Object]"===c(a)},A.isArray=function(a){return"[object Array]"===c(a)},A.isRegexp=function(a){return"[object RegExp]"===c(a)},d.prototype=Object.create(Error.prototype),q.prototype.get=function(){return this.value},q.prototype.set=function(a){return this.validate(a),this.value},q.prototype.required=function(){return this.isRequired=!0,this},q.prototype.setDefault=function(a){return this.defaultValue=a,this},q.prototype.regex=function(a,b){return this.asserts.push(new h(a,b)),this},q.prototype.getLongname=function(){for(var a=[this.name],b=this;b=b.parent;)"root"!==b.name&&a.push(b.name);return"root["+a.reverse().join("][")+"]"},q.prototype.validate=function(a){var b,c,d;if("undefined"==typeof a){if(!0===this.isRequired)throw new Error("Node `"+this.getLongname()+"` is required.");if(!this.defaultValue)return this.value;a=this.defaultValue}for(d=0;d<this.asserts.length;d++)this.asserts[d].test(this,a);if(!0===this.allowChildNodes&&!0===A.isArray(a))if(b=[],this.childNodes&&this.childNodes.all)for(d=0;d<a.length;d++)b[d]=this.childNodes.all.set(a[d]);else for(c in this.childNodes)b[c]=this.childNodes[c].set(a[c]);else if(!0===this.allowChildNodes&&!0===A.isObject(a))if(b={},this.childNodes&&this.childNodes.all)for(c in a)b[c]=this.childNodes.all.set(a[c]);else for(c in this.childNodes)b[c]=this.childNodes[c].set(a[c]);else b=a;return this.value=b,this.value},q.prototype.end=function(){return this.parent&&!0===this.parent.allowChildNodes&&this.parent.nodeChildren?this.parent.nodeChildren:this.parent||this},q.prototype.children=function(){if(!0===this.allowChildNodes)return this.nodeChildren||(this.nodeChildren=new v(this)),this.nodeChildren;throw new Error("Node "+this.name+" cannot carry any children, only `Object`, `Array` and `Mixed` nodes do.")},r.prototype=Object.create(q.prototype),s.prototype=Object.create(q.prototype),t.prototype=Object.create(q.prototype),u.prototype=Object.create(q.prototype),w.prototype=Object.create(q.prototype),x.prototype=Object.create(q.prototype),y.prototype=Object.create(q.prototype),z.StringNode=y,z.NumberNode=w,z.BooleanNode=s,z.ArrayNode=r,z.ObjectNode=x,z.MixedNode=u,z.FunctionNode=t,"function"==typeof define&&define.amd?define([],function(){return z}):"object"==typeof exports?module.exports=z:a.configurator=z}(this);