/*! configurator 06-09-2014 */
!function(a,b){"use strict";function c(a,b,c){Error.apply(this,[c]),this.node=a,this.name="AssertError",this.assert=b,this.message=a.getLongname()+": "+c}function d(a,b){this.test=function(d,e){if("number"==typeof a&&e.length<a)throw new c(d,"CountAssert","Expected array to contain `"+a+"` or more values");if("number"==typeof b&&e.length>b)throw new c(d,"CountAssert","Expected array to contain `"+b+"` or less values")}}function e(a){this.args=Array.prototype.slice.call(arguments,0),this.test=function(b,d){if("string"==typeof d&&d.length<=a)throw new c(b,"GreaterThanAssert","Expected value to contain "+a+" or more characters");if("number"==typeof d&&a>=d)throw new c(b,"GreaterThanAssert","Expected value to be greater than "+a+" but is "+d);return!0}}function f(a){this.test=function(b,d){if("string"==typeof d&&d.length>=a)throw new c(b,"LessThanAssert","Expected value to contain "+a+" or less characters");if("number"==typeof d&&d>=a)throw new c(b,"LessThanAssert","Expected value to be less than "+a+" but is "+d);return!0}}function g(a,b){var d=new RegExp(a),e=b||!0;this.test=function(a,b){if(d.test(b)!==e)throw new c(a,"RegexAssert","Expected value to match regex `"+d.toString()+"`")}}function h(a){this.test=function(b,d){if(a&&-1===a.indexOf(d))throw new c(b,"ChoiceAssert","Given value is not a valid choise, choose from ["+a.join(",")+"]")}}function i(){this.test=function(a,b){if(""===b)throw new c(a,"NotEmptyAssert","Expect value not to be blank")}}function j(){this.test=function(a,b){if("string"!=typeof b)throw new c(a,"String","type mismatch expected `string` got `"+typeof b+"`");return!0}}function k(){this.test=function(a,b){if("number"!=typeof b)throw new c(a,"Number","type mismatch expected `number` got `"+typeof b+"`");return!0}}function l(){this.test=function(a,b){if("boolean"!=typeof b)throw new c(a,"Boolean","type mismatch expected `boolean` got `"+typeof b+"`");return!0}}function m(){this.test=function(a,b){var d=Object.prototype.toString.call(b);if("[object Object]"!==d)throw new c(a,"Object","type mismatch expected `[object Object]` got `"+d+"`");return!0}}function n(){this.test=function(a,b){var d=Object.prototype.toString.call(b);if("[object Array]"!==d)throw new c(a,"Array","type mismatch expected `[object Array]` got `"+d+"`");return!0}}function o(a,c,d,e,f){if(this.name=a,this.parent=e,this.isRequired=!1,this.childNodes={},this.nodeChildren=null,this.allowChildNodes=f||!1,this.asserts=c?[c]:[],this.defaultValue=null,this.value=b,!0===this.allowChildNodes&&d&&d.length>0)for(var g=0;g<d.length;g++)d[g].parent=this,this.childNodes[d[g].name]=d[g];e&&e.childNodes&&(e.childNodes[a]=this)}function p(a,b,c){o.apply(this,[a,new n,b,c,!0]),this.count=function(a,b){return this.asserts.push(new d(a,b)),this}}function q(a,b,c){o.apply(this,[a,new l,b,c,!1])}function r(a,b,c){o.apply(this,[a,null,b,c,!0]),this.greaterThan=function(a){return this.asserts.push(new e(a)),this},this.lessThan=function(a){return this.asserts.push(new f(a)),this},this.choice=function(a){return this.asserts.push(new h(a)),this},this.notEmpty=function(){return this.asserts.push(new i),this}}function s(a){this.objectNode=function(b){return new u(b,null,a)},this.arrayNode=function(b){return new p(b,null,a)},this.stringNode=function(b){return new v(b,null,a)},this.booleanNode=function(b){return new q(b,null,a)},this.numberNode=function(b){return new t(b,null,a)},this.mixedNode=function(b){return new r(b,null,a)},this.end=function(){return a}}function t(a,b,c){o.apply(this,[a,new k,b,c,!1]),this.greaterThan=function(a){return this.asserts.push(new e(a)),this},this.lessThan=function(a){return this.asserts.push(new f(a)),this},this.choice=function(a){return this.asserts.push(new h(a)),this}}function u(a,b,c){o.apply(this,[a,new m,b,c,!0])}function v(a,b,c){o.apply(this,[a,new j,b,c,!1]),this.greaterThan=function(a){return this.asserts.push(new e(a)),this},this.lessThan=function(a){return this.asserts.push(new f(a)),this},this.choice=function(a){return this.asserts.push(new h(a)),this},this.notEmpty=function(){return this.asserts.push(new i),this}}function w(a){return a&&"[object Array]"===Object.prototype.toString.call(a)?new u("root",a,null):new u("root",null,null)}c.prototype=Object.create(Error.prototype),o.prototype.get=function(){return this.value},o.prototype.set=function(a){return this.validate(a),this.value},o.prototype.required=function(){return this.isRequired=!0,this},o.prototype.setDefault=function(a){return this.defaultValue=a,this},o.prototype.regex=function(a,b){return this.asserts.push(new g(a,b)),this},o.prototype.getLongname=function(){for(var a=[this.name],b=this;b=b.parent;)"root"!==b.name&&a.push(b.name);return"root["+a.reverse().join("][")+"]"},o.prototype.validate=function(a){var b,c,d;if("undefined"==typeof a){if(!0===this.isRequired)throw new Error("Node `"+this.getLongname()+"` is required.");if(!this.defaultValue)return this.value;a=this.defaultValue}for(d=0;d<this.asserts.length;d++)this.asserts[d].test(this,a);if(!0===this.allowChildNodes){if("[object Array]"===Object.prototype.toString.call(a))if(b=[],this.childNodes&&this.childNodes.all)for(d=0;d<a.length;d++)b[d]=this.childNodes.all.set(a[d]);else for(c in this.childNodes)b[c]=this.childNodes[c].set(a[c]);else if("[object Object]"===Object.prototype.toString.call(a))if(b={},this.childNodes&&this.childNodes.all)for(c in a)b[c]=this.childNodes.all.set(a[c]);else for(c in this.childNodes)b[c]=this.childNodes[c].set(a[c])}else b=a;return this.value=b,this.value},o.prototype.end=function(){return this.parent&&!0===this.parent.allowChildNodes&&this.parent.nodeChildren?this.parent.nodeChildren:this.parent||this},o.prototype.children=function(){if(!0===this.allowChildNodes)return this.nodeChildren||(this.nodeChildren=new s(this)),this.nodeChildren;throw new Error("Node "+this.name+" cannot carry any children, only `Object` and `Array` nodes do.")},p.prototype=Object.create(o.prototype),q.prototype=Object.create(o.prototype),r.prototype=Object.create(o.prototype),t.prototype=Object.create(o.prototype),u.prototype=Object.create(o.prototype),v.prototype=Object.create(o.prototype),w.StringNode=v,w.NumberNode=t,w.BooleanNode=q,w.ArrayNode=p,w.ObjectNode=u,w.MixedNode=r,"function"==typeof define&&define.amd?define([],w):"object"==typeof exports?module.exports=w:a.configurator=w}(this);