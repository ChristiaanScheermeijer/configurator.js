/*! configurator 03-11-2014 */
!function(a,b){"use strict";function c(a){return Object.prototype.toString.call(a)}function d(a,b,c){Error.apply(this,[c]),this.node=a,this.name="AssertError",this.assert=b,this.message=a.getLongname()+": "+c}function e(a,b){this.test=function(c,e){if(E.isArray(e)){if(E.isNumber(a)&&e.length<a)throw new d(c,"CountAssert","Expected array to contain "+a+" or more values");if(E.isNumber(b)&&e.length>b)throw new d(c,"CountAssert","Expected array to contain "+b+" or less values")}}}function f(a){this.args=Array.prototype.slice.call(arguments,0),this.test=function(b,c){if(E.isString(c)&&c.length<=a)throw new d(b,"GreaterThanAssert","Expected value to contain "+a+" or more characters");if(E.isNumber(c)&&a>=c)throw new d(b,"GreaterThanAssert","Expected value to be greater than "+a+" but is "+c);return!0}}function g(a){this.test=function(b,c){if(E.isString(c)&&c.length>=a)throw new d(b,"LessThanAssert","Expected value to contain "+a+" or less characters");if(E.isNumber(c)&&c>=a)throw new d(b,"LessThanAssert","Expected value to be less than "+a+" but is "+c);return!0}}function h(a,b){var c;E.isRegexp(a)?c=a:E.isString(a)&&(c=new RegExp(a));var e=b||!0;this.test=function(a,b){if(c.lastIndex=0,!0===E.isString(b)||!0===E.isNumber(b)){if(!0!==E.isRegexp(c))throw new d(a,"WrongRegexAssert","Regex not valid");if(c.test(b)!==e)throw new d(a,"RegexAssert","Expected value to match regex `"+c.toString()+"`")}}}function i(a){this.test=function(b,c){if(E.isArray(a)&&-1===a.indexOf(c))throw new d(b,"ChoiceAssert","Given value is not a valid choice, choose from ["+a.join(",")+"]")}}function j(){this.test=function(a,b){if(""===b)throw new d(a,"NotEmptyAssert","Expect value not to be blank")}}function k(){this.test=function(a,b){if(!1===E.isString(b))throw new d(a,"String","type mismatch expected `[object String]` got `"+E.callToString(b)+"`");return!0}}function l(){this.test=function(a,b){if(!1===E.isNumber(b))throw new d(a,"Number","type mismatch expected `[object Number]` got `"+E.callToString(b)+"`");return!0}}function m(){this.test=function(a,b){if(!1===E.isBoolean(b))throw new d(a,"Boolean","type mismatch expected `[object Boolean]` got `"+E.callToString(b)+"`");return!0}}function n(){this.test=function(a,b){if(!1===E.isObject(b))throw new d(a,"Object","type mismatch expected `[object Object]` got `"+E.callToString(b)+"`");return!0}}function o(){this.test=function(a,b){if(!1===E.isArray(b))throw new d(a,"Array","type mismatch expected `[object Array]` got `"+E.callToString(b)+"`");return!0}}function p(){this.test=function(a,b){if(!1===E.isFunction(b))throw new d(a,"Function","type mismatch expected `[object Function]` got `"+E.callToString(b)+"`");return!0}}function q(){this.test=function(a,b){if(!1===E.isRegexp(b))throw new d(a,"Regex","type mismatch expected `[object Regexp]` got `"+E.callToString(b)+"`");return!0}}function r(){this.test=function(a,b){if(!1===E.isDate(b))throw new d(a,"Date","type mismatch expected `[object Date]` got `"+E.callToString(b)+"`");return!0}}function s(a,c,d,e,f){if(this.name=a,this.parent=e,this.isRequired=!1,this.childNodes={},this.childNodesAll=null,this.nodeChildren=null,this.allowChildNodes=f||!1,this.asserts=c?[c]:[],this.defaultValue=b,this.value=b,this.modifiers=[],!0===this.allowChildNodes&&!0===E.isArray(d))if(1===d.length&&"all"===d[0].name)this.childNodesAll=d[0],this.childNodesAll.parent=this;else for(var g=0;g<d.length;g++)d[g].parent=this,this.childNodes[d[g].name]=d[g];e&&e.childNodes&&("all"===this.name?e.childNodesAll=this:e.childNodes[a]=this)}function t(a,b,c){s.apply(this,[a,new o,b,c,!0]),this.count=function(a,b){return this.asserts.push(new e(a,b)),this}}function u(a,b,c){s.apply(this,[a,new m,b,c,!1])}function v(a,b,c){s.apply(this,[a,new r,b,c,!0])}function w(a,b,c){s.apply(this,[a,new p,b,c,!1])}function x(a,b,c){s.apply(this,[a,null,b,c,!0]),this.greaterThan=function(a){return this.asserts.push(new f(a)),this},this.lessThan=function(a){return this.asserts.push(new g(a)),this},this.choice=function(a){return this.asserts.push(new i(a)),this},this.notEmpty=function(){return this.asserts.push(new j),this},this.regex=function(a,b){return this.asserts.push(new h(a,b)),this}}function y(a){this.objectNode=function(b){return new A(b,null,a)},this.arrayNode=function(b){return new t(b,null,a)},this.stringNode=function(b){return new C(b,null,a)},this.booleanNode=function(b){return new u(b,null,a)},this.numberNode=function(b){return new z(b,null,a)},this.mixedNode=function(b){return new x(b,null,a)},this.functionNode=function(b){return new w(b,null,a)},this.regexNode=function(b){return new B(b,null,a)},this.dateNode=function(b){return new v(b,null,a)},this.end=function(){return a}}function z(a,b,c){s.apply(this,[a,new l,b,c,!1]),this.greaterThan=function(a){return this.asserts.push(new f(a)),this},this.lessThan=function(a){return this.asserts.push(new g(a)),this},this.choice=function(a){return this.asserts.push(new i(a)),this},this.regex=function(a,b){return this.asserts.push(new h(a,b)),this}}function A(a,b,c){s.apply(this,[a,new n,b,c,!0])}function B(a,b,c){s.apply(this,[a,new q,b,c,!0])}function C(a,b,c){s.apply(this,[a,new k,b,c,!1]),this.greaterThan=function(a){return this.asserts.push(new f(a)),this},this.lessThan=function(a){return this.asserts.push(new g(a)),this},this.choice=function(a){return this.asserts.push(new i(a)),this},this.notEmpty=function(){return this.asserts.push(new j),this},this.regex=function(a,b){return this.asserts.push(new h(a,b)),this}}function D(a){return a&&"[object Array]"===Object.prototype.toString.call(a)?new A("root",a,null):new A("root",null,null)}var E={};E.callToString=c,E.isString=function(a){return"string"==typeof a||"[object String]"==c(a)},E.isNumber=function(a){return"number"==typeof a||"[object Number]"==c(a)},E.isBoolean=function(a){return"boolean"==typeof a||"[object Boolean]"==c(a)},E.isFunction=function(a){return"function"==typeof a||"[object Function]"===c(a)},E.isObject=function(a){return"[object Object]"===c(a)},E.isArray=function(a){return"[object Array]"===c(a)},E.isRegexp=function(a){return"[object RegExp]"===c(a)},E.isDate=function(a){return"[object Date]"===c(a)},d.prototype=Object.create(Error.prototype),s.prototype.get=function(){return this.value},s.prototype.set=function(a){return this.value=this.validate(a),this.value},s.prototype.required=function(){return this.isRequired=!0,this},s.prototype.setDefault=function(a){return this.defaultValue=a,this},s.prototype.getLongname=function(){for(var a=[this.name],b=this;b=b.parent;)"root"!==b.name&&a.push(b.name);return"root["+a.reverse().join("][")+"]"},s.prototype.addModifier=function(a){return"function"==typeof a&&this.modifiers.push(a),this},s.prototype.validate=function(a){var c,d,e;if("undefined"==typeof a){if(!0===this.isRequired)throw new Error("Node `"+this.getLongname()+"` is required.");if("undefined"==typeof this.defaultValue)return b;a=this.defaultValue}for(e=0;e<this.asserts.length;e++)this.asserts[e].test(this,a);if(!0===this.allowChildNodes&&!0===E.isArray(a))if(c=[],this.childNodesAll)for(e=0;e<a.length;e++){var f=this.childNodesAll.clone();c[e]=f.set(a[e]),console.log(f)}else for(d in this.childNodes)c[d]=this.childNodes[d].set(a[d]);else if(!0===this.allowChildNodes&&!0===E.isObject(a))if(c={},this.childNodesAll)for(d in a)c[d]=this.childNodesAll.clone().set(a[d]);else for(d in this.childNodes)c[d]=this.childNodes[d].set(a[d]);else c=a;if(this.modifiers.length>0&&this.defaultValue!=c)for(var g=0;g<this.modifiers.length;g++)c=this.modifiers[g].call(this,c);return c},s.prototype.end=function(){return this.parent&&!0===this.parent.allowChildNodes&&this.parent.nodeChildren?this.parent.nodeChildren:this.parent||this},s.prototype.children=function(){if(!0===this.allowChildNodes)return this.nodeChildren||(this.nodeChildren=new y(this)),this.nodeChildren;throw new Error("Node "+this.name+" cannot carry any children, only `Object`, `Array` and `Mixed` nodes do.")},s.prototype.clone=function(){var a=new this.constructor("clone",[],null);a.parent=this.parent,a.asserts=this.asserts,a.defaultValue=this.defaultValue,a.isRequired=this.isRequired,a.modifiers=this.modifiers,a.allowChildNodes=this.allowChildNodes;for(var b in this.childNodes)a.childNodes[b]=this.childNodes[b].clone();return a},t.prototype=Object.create(s.prototype),t.prototype.constructor=t,u.prototype=Object.create(s.prototype),u.prototype.constructor=u,v.prototype=Object.create(s.prototype),v.prototype.constructor=v,w.prototype=Object.create(s.prototype),w.prototype.constructor=w,x.prototype=Object.create(s.prototype),x.prototype.constructor=x,z.prototype=Object.create(s.prototype),z.prototype.constructor=z,A.prototype=Object.create(s.prototype),A.prototype.constructor=A,B.prototype=Object.create(s.prototype),B.prototype.constructor=B,C.prototype=Object.create(s.prototype),C.prototype.constructor=C,D.StringNode=C,D.NumberNode=z,D.BooleanNode=u,D.ArrayNode=t,D.ObjectNode=A,D.MixedNode=x,D.FunctionNode=w,D.RegexNode=B,D.DateNode=v,"function"==typeof define&&define.amd?define([],function(){return D}):"object"==typeof exports?module.exports=D:a.configurator=D}(this);