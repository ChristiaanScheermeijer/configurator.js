/*! configurator 22-09-2014 */
!function(a,b){"use strict";function c(a){return Object.prototype.toString.call(a)}function d(a,b,c){Error.apply(this,[c]),this.node=a,this.name="AssertError",this.assert=b,this.message=a.getLongname()+": "+c}function e(a,b){this.test=function(c,e){if(C.isArray(e)){if(C.isNumber(a)&&e.length<a)throw new d(c,"CountAssert","Expected array to contain "+a+" or more values");if(C.isNumber(b)&&e.length>b)throw new d(c,"CountAssert","Expected array to contain "+b+" or less values")}}}function f(a){this.args=Array.prototype.slice.call(arguments,0),this.test=function(b,c){if(C.isString(c)&&c.length<=a)throw new d(b,"GreaterThanAssert","Expected value to contain "+a+" or more characters");if(C.isNumber(c)&&a>=c)throw new d(b,"GreaterThanAssert","Expected value to be greater than "+a+" but is "+c);return!0}}function g(a){this.test=function(b,c){if(C.isString(c)&&c.length>=a)throw new d(b,"LessThanAssert","Expected value to contain "+a+" or less characters");if(C.isNumber(c)&&c>=a)throw new d(b,"LessThanAssert","Expected value to be less than "+a+" but is "+c);return!0}}function h(a,b){var c;C.isRegexp(a)?c=a:C.isString(a)&&(c=new RegExp(a));var e=b||!0;this.test=function(a,b){if(!0!==C.isRegexp(c))throw new d(a,"WrongRegexAssert","Regex not valid");if(c.test(b)!==e)throw new d(a,"RegexAssert","Expected value to match regex `"+c.toString()+"`")}}function i(a){this.test=function(b,c){if(C.isArray(a)&&-1===a.indexOf(c))throw new d(b,"ChoiceAssert","Given value is not a valid choice, choose from ["+a.join(",")+"]")}}function j(){this.test=function(a,b){if(""===b)throw new d(a,"NotEmptyAssert","Expect value not to be blank")}}function k(){this.test=function(a,b){if(!1===C.isString(b))throw new d(a,"String","type mismatch expected `[object String]` got `"+C.callToString(b)+"`");return!0}}function l(){this.test=function(a,b){if(!1===C.isNumber(b))throw new d(a,"Number","type mismatch expected `[object Number]` got `"+C.callToString(b)+"`");return!0}}function m(){this.test=function(a,b){if(!1===C.isBoolean(b))throw new d(a,"Boolean","type mismatch expected `[object Boolean]` got `"+C.callToString(b)+"`");return!0}}function n(){this.test=function(a,b){if(!1===C.isObject(b))throw new d(a,"Object","type mismatch expected `[object Object]` got `"+C.callToString(b)+"`");return!0}}function o(){this.test=function(a,b){if(!1===C.isArray(b))throw new d(a,"Array","type mismatch expected `[object Array]` got `"+C.callToString(b)+"`");return!0}}function p(){this.test=function(a,b){if(!1===C.isFunction(b))throw new d(a,"Function","type mismatch expected `[object Function]` got `"+C.callToString(b)+"`");return!0}}function q(){this.test=function(a,b){if(!1===C.isRegexp(b))throw new d(a,"Regex","type mismatch expected `[object Regexp]` got `"+C.callToString(b)+"`");return!0}}function r(a,c,d,e,f){if(this.name=a,this.parent=e,this.isRequired=!1,this.childNodes={},this.nodeChildren=null,this.allowChildNodes=f||!1,this.asserts=c?[c]:[],this.defaultValue=null,this.value=b,!0===this.allowChildNodes&&!0===C.isArray(d)&&d.length>0)for(var g=0;g<d.length;g++)d[g].parent=this,this.childNodes[d[g].name]=d[g];e&&e.childNodes&&(e.childNodes[a]=this)}function s(a,b,c){r.apply(this,[a,new o,b,c,!0]),this.count=function(a,b){return this.asserts.push(new e(a,b)),this}}function t(a,b,c){r.apply(this,[a,new m,b,c,!1])}function u(a,b,c){r.apply(this,[a,new p,b,c,!1])}function v(a,b,c){r.apply(this,[a,null,b,c,!0]),this.greaterThan=function(a){return this.asserts.push(new f(a)),this},this.lessThan=function(a){return this.asserts.push(new g(a)),this},this.choice=function(a){return this.asserts.push(new i(a)),this},this.notEmpty=function(){return this.asserts.push(new j),this}}function w(a){this.objectNode=function(b){return new y(b,null,a)},this.arrayNode=function(b){return new s(b,null,a)},this.stringNode=function(b){return new A(b,null,a)},this.booleanNode=function(b){return new t(b,null,a)},this.numberNode=function(b){return new x(b,null,a)},this.mixedNode=function(b){return new v(b,null,a)},this.functionNode=function(b){return new u(b,null,a)},this.regexNode=function(b){return new z(b,null,a)},this.end=function(){return a}}function x(a,b,c){r.apply(this,[a,new l,b,c,!1]),this.greaterThan=function(a){return this.asserts.push(new f(a)),this},this.lessThan=function(a){return this.asserts.push(new g(a)),this},this.choice=function(a){return this.asserts.push(new i(a)),this}}function y(a,b,c){r.apply(this,[a,new n,b,c,!0])}function z(a,b,c){r.apply(this,[a,new q,b,c,!0]),this.regex=null}function A(a,b,c){r.apply(this,[a,new k,b,c,!1]),this.greaterThan=function(a){return this.asserts.push(new f(a)),this},this.lessThan=function(a){return this.asserts.push(new g(a)),this},this.choice=function(a){return this.asserts.push(new i(a)),this},this.notEmpty=function(){return this.asserts.push(new j),this}}function B(a){return a&&"[object Array]"===Object.prototype.toString.call(a)?new y("root",a,null):new y("root",null,null)}var C={};C.callToString=c,C.isString=function(a){return"string"==typeof a||"[object String]"==c(a)},C.isNumber=function(a){return"number"==typeof a||"[object Number]"==c(a)},C.isBoolean=function(a){return"boolean"==typeof a||"[object Boolean]"==c(a)},C.isFunction=function(a){return"function"==typeof a||"[object Function]"===c(a)},C.isObject=function(a){return"[object Object]"===c(a)},C.isArray=function(a){return"[object Array]"===c(a)},C.isRegexp=function(a){return"[object RegExp]"===c(a)},d.prototype=Object.create(Error.prototype),r.prototype.get=function(){return this.value},r.prototype.set=function(a){return this.validate(a),this.value},r.prototype.required=function(){return this.isRequired=!0,this},r.prototype.setDefault=function(a){return this.defaultValue=a,this},r.prototype.regex=function(a,b){return this.asserts.push(new h(a,b)),this},r.prototype.getLongname=function(){for(var a=[this.name],b=this;b=b.parent;)"root"!==b.name&&a.push(b.name);return"root["+a.reverse().join("][")+"]"},r.prototype.validate=function(a){var b,c,d;if("undefined"==typeof a){if(!0===this.isRequired)throw new Error("Node `"+this.getLongname()+"` is required.");if(!this.defaultValue)return this.value;a=this.defaultValue}for(d=0;d<this.asserts.length;d++)this.asserts[d].test(this,a);if(!0===this.allowChildNodes&&!0===C.isArray(a))if(b=[],this.childNodes&&this.childNodes.all)for(d=0;d<a.length;d++)b[d]=this.childNodes.all.set(a[d]);else for(c in this.childNodes)b[c]=this.childNodes[c].set(a[c]);else if(!0===this.allowChildNodes&&!0===C.isObject(a))if(b={},this.childNodes&&this.childNodes.all)for(c in a)b[c]=this.childNodes.all.set(a[c]);else for(c in this.childNodes)b[c]=this.childNodes[c].set(a[c]);else b=a;return this.value=b,this.value},r.prototype.end=function(){return this.parent&&!0===this.parent.allowChildNodes&&this.parent.nodeChildren?this.parent.nodeChildren:this.parent||this},r.prototype.children=function(){if(!0===this.allowChildNodes)return this.nodeChildren||(this.nodeChildren=new w(this)),this.nodeChildren;throw new Error("Node "+this.name+" cannot carry any children, only `Object`, `Array` and `Mixed` nodes do.")},s.prototype=Object.create(r.prototype),t.prototype=Object.create(r.prototype),u.prototype=Object.create(r.prototype),v.prototype=Object.create(r.prototype),x.prototype=Object.create(r.prototype),y.prototype=Object.create(r.prototype),z.prototype=Object.create(r.prototype),A.prototype=Object.create(r.prototype),B.StringNode=A,B.NumberNode=x,B.BooleanNode=t,B.ArrayNode=s,B.ObjectNode=y,B.MixedNode=v,B.FunctionNode=u,B.RegexNode=z,"function"==typeof define&&define.amd?define([],function(){return B}):"object"==typeof exports?module.exports=B:a.configurator=B}(this);